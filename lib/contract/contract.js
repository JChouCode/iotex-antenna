"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Contract = void 0;

var _ethereumjsAbi = _interopRequireDefault(require("ethereumjs-abi"));

var _method = require("../action/method");

var _address = require("../crypto/address");

var _abiToByte = require("./abi-to-byte");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : { default: obj };
}

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }
  return obj;
}

class Contract {
  // The json interface for the contract to instantiate
  // This address is necessary for executions and call requests
  // The options of the contract.
  setProvider(provider) {
    this.provider = provider;
  }

  constructor(jsonInterface, address, options) { // tslint:disable-next-line: no-any
    _defineProperty(this, "abi", void 0);

    _defineProperty(this, "address", void 0);

    _defineProperty(this, "options", void 0);

    _defineProperty(this, "provider", void 0);

    _defineProperty(this, "methods", void 0);

    this.provider = options && options.provider;

    if (jsonInterface) {
      this.abi = (0, _abiToByte.getAbiFunctions)(jsonInterface);
    }

    this.address = address;
    this.options = options; // mount methods

    this.methods = {}; // tslint:disable-next-line: no-for-in

    for (const func in this.abi) {
      if (!this.abi.hasOwnProperty(func)) {
        // eslint-disable-next-line no-continue
        continue;
      }

      this.methods[func] = async (
        // @ts-ignore
        ...args
      ) => {
        if (!this.address || !this.abi) {
          throw new Error("must set contract address and abi");
        }

        if (args.length < 1) {
          throw new Error("must set method execute parameter");
        }

        if (!this.provider) {
          throw new Error("no rpc method provider specified");
        }

        const executeParameter = args[args.length - 1];
        const abiFunc = this.abi[func];
        const userInput = {};

        if (!abiFunc.inputs || !Array.isArray(abiFunc.inputs)) {
          return userInput;
        } // tslint:disable-next-line: no-any

        abiFunc.inputs.map((val, i) => {
          // @ts-ignore
          userInput[val.name] = args[i];
        });

        if (abiFunc.stateMutability === "view") {
          const result = await this.provider.readContract({
            execution: this.pureEncodeMethod(
              "0",
              func,
              ...args.slice(1, args.length)
            ),
            callerAddress: this.address
          });
          return this.decodeMethodResult(func, result.data);
        }

        const methodEnvelop = this.encodeMethod(
          executeParameter.amount || "0",
          func,
          userInput,
          executeParameter.gasLimit,
          executeParameter.gasPrice
        );
        const method = new _method.ExecutionMethod(
          this.provider,
          executeParameter.account,
          methodEnvelop,
          {
            signer: this.options && this.options.signer
          }
        );
        return method.execute();
      };
    }
  } // tslint:disable-next-line: no-any

  getABI() {
    return this.abi;
  }

  getAddress() {
    return this.address;
  }

  async deploy(
    account, // tslint:disable-next-line: no-any
    inputs,
    gasLimit,
    gasPrice
  ) {
    if (!this.options) {
      throw new Error("must set contract byte code");
    }

    if (!this.provider) {
      throw new Error("no rpc method provider specified");
    }

    let data = this.options.data || Buffer.from([]);

    if (this.abi && this.abi.hasOwnProperty(_abiToByte.Constructor)) {
      const abiFunc = this.abi[_abiToByte.Constructor];
      const userInput = {}; // @ts-ignore

      if (!abiFunc.inputs || !Array.isArray(abiFunc.inputs)) {
        throw new Error("construtor input error");
      } // @ts-ignore
      // tslint:disable-next-line: no-any

      abiFunc.inputs.map((val, i) => {
        // @ts-ignore
        userInput[val.name] = inputs[i];
      });
      data = Buffer.concat([
        data, // @ts-ignore
        Buffer.from(
          (0, _abiToByte.encodeArguments)(
            (0, _abiToByte.getArgTypes)(abiFunc),
            userInput
          ),
          "hex"
        )
      ]);
    }

    const contractEnvelop = {
      gasLimit: gasLimit,
      gasPrice: gasPrice,
      contract: "",
      amount: "0",
      data: data
    };
    return new _method.ExecutionMethod(
      this.provider,
      account,
      contractEnvelop,
      {
        signer: this.options && this.options.signer
      }
    ).execute();
  }

  pureEncodeMethod(
    amount,
    method, // @ts-ignore
    // tslint:disable-next-line: typedef
    ...args
  ) {
    if (!this.address || !this.abi) {
      throw new Error("must set contract address and abi");
    }

    if (!this.abi[method]) {
      throw new Error(`method ${method} dose not in abi`);
    }

    const abiFunc = this.abi[method];
    const userInput = {}; // tslint:disable-next-line: no-any

    abiFunc.inputs.map((val, i) => {
      // @ts-ignore
      userInput[val.name] = args[i];
    });
    return this.encodeMethod(amount, method, userInput);
  }

  encodeMethod(
    amount,
    method, // tslint:disable-next-line:no-any
    input,
    gasLimit,
    gasPrice
  ) {
    if (!this.address || !this.abi) {
      throw new Error("must set contract address and abi");
    }

    if (!this.abi[method]) {
      throw new Error(`method ${method} dose not in abi`);
    }

    return {
      gasLimit: gasLimit,
      gasPrice: gasPrice,
      contract: this.address,
      amount: amount,
      data: Buffer.from(
        (0, _abiToByte.encodeInputData)(this.abi, method, input),
        "hex"
      )
    };
  }

  decodeMethodResult(method, result) {
    const outTypes = []; // @ts-ignore

    this.getABI()[method].outputs.forEach(field => {
      outTypes.push(field.type);
    });

    if (outTypes.length === 0) {
      return null;
    }

    const results = _ethereumjsAbi.default.rawDecode(
      outTypes,
      Buffer.from(result, "hex")
    );

    for (let i = 0; i < outTypes.length; i++) {
      if (outTypes[i] === "address") {
        results[i] = (0, _address.fromBytes)(
          Buffer.from(results[i].toString(), "hex")
        ).string();
      }

      if (outTypes[i] === "address[]") {
        for (let j = 0; j < results[i].length; j++) {
          results[i][j] = (0, _address.fromBytes)(
            Buffer.from(results[i][j].toString(), "hex")
          ).string();
        }
      }
    }

    if (outTypes.length === 1) {
      return results[0];
    }

    return results;
  }
}

exports.Contract = Contract;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb250cmFjdC9jb250cmFjdC50cyJdLCJuYW1lcyI6WyJDb250cmFjdCIsInNldFByb3ZpZGVyIiwicHJvdmlkZXIiLCJjb25zdHJ1Y3RvciIsImpzb25JbnRlcmZhY2UiLCJhZGRyZXNzIiwib3B0aW9ucyIsImFiaSIsIm1ldGhvZHMiLCJmdW5jIiwiaGFzT3duUHJvcGVydHkiLCJhcmdzIiwiRXJyb3IiLCJsZW5ndGgiLCJleGVjdXRlUGFyYW1ldGVyIiwiYWJpRnVuYyIsInVzZXJJbnB1dCIsImlucHV0cyIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsInZhbCIsImkiLCJuYW1lIiwic3RhdGVNdXRhYmlsaXR5IiwicmVzdWx0IiwicmVhZENvbnRyYWN0IiwiZXhlY3V0aW9uIiwicHVyZUVuY29kZU1ldGhvZCIsInNsaWNlIiwiY2FsbGVyQWRkcmVzcyIsImRlY29kZU1ldGhvZFJlc3VsdCIsImRhdGEiLCJtZXRob2RFbnZlbG9wIiwiZW5jb2RlTWV0aG9kIiwiYW1vdW50IiwiZ2FzTGltaXQiLCJnYXNQcmljZSIsIm1ldGhvZCIsIkV4ZWN1dGlvbk1ldGhvZCIsImFjY291bnQiLCJzaWduZXIiLCJleGVjdXRlIiwiZ2V0QUJJIiwiZ2V0QWRkcmVzcyIsImRlcGxveSIsIkJ1ZmZlciIsImZyb20iLCJDb25zdHJ1Y3RvciIsImNvbmNhdCIsImNvbnRyYWN0RW52ZWxvcCIsImNvbnRyYWN0IiwiaW5wdXQiLCJvdXRUeXBlcyIsIm91dHB1dHMiLCJmb3JFYWNoIiwiZmllbGQiLCJwdXNoIiwidHlwZSIsInJlc3VsdHMiLCJldGhlcmV1bWpzIiwicmF3RGVjb2RlIiwidG9TdHJpbmciLCJzdHJpbmciLCJqIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7Ozs7OztBQWdCTyxNQUFNQSxRQUFOLENBQWU7QUFDcEI7QUFHQTtBQUdBO0FBT09DLEVBQUFBLFdBQVAsQ0FBbUJDLFFBQW5CLEVBQStDO0FBQzdDLFNB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QUF1Q21ELENBQUMsRUFBeEMsRUFBNEM7QUFDMUNMLFVBQUFBLE9BQU8sQ0FBQ3JDLENBQUQsQ0FBUCxDQUFXMEMsQ0FBWCxJQUFnQix3QkFDZGxCLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZWSxPQUFPLENBQUNyQyxDQUFELENBQVAsQ0FBVzBDLENBQVgsRUFBY0YsUUFBZCxFQUFaLEVBQXNDLEtBQXRDLENBRGMsRUFFZEMsTUFGYyxFQUFoQjtBQUdEO0FBQ0Y7QUFDRjs7QUFFRCxRQUFJVixRQUFRLENBQUN4QyxNQUFULEtBQW9CLENBQXhCLEVBQTJCO0FBQ3pCLGFBQU84QyxPQUFPLENBQUMsQ0FBRCxDQUFkO0FBQ0Q7O0FBQ0QsV0FBT0EsT0FBUDtBQUNEOztBQTFPbUIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiB0c2xpbnQ6ZGlzYWJsZTpuby1hbnkgKi9cbmltcG9ydCBldGhlcmV1bWpzIGZyb20gXCJldGhlcmV1bWpzLWFiaVwiO1xuaW1wb3J0IHsgSUFjY291bnQgfSBmcm9tIFwiLi4vYWNjb3VudC9hY2NvdW50XCI7XG5pbXBvcnQgeyBFeGVjdXRpb25NZXRob2QsIFNpZ25lclBsdWdpbiB9IGZyb20gXCIuLi9hY3Rpb24vbWV0aG9kXCI7XG5pbXBvcnQgeyBFeGVjdXRpb24gfSBmcm9tIFwiLi4vYWN0aW9uL3R5cGVzXCI7XG5pbXBvcnQgeyBmcm9tQnl0ZXMgfSBmcm9tIFwiLi4vY3J5cHRvL2FkZHJlc3NcIjtcbmltcG9ydCB7IElScGNNZXRob2QgfSBmcm9tIFwiLi4vcnBjLW1ldGhvZC90eXBlc1wiO1xuaW1wb3J0IHtcbiAgQWJpQnlGdW5jLFxuICBDb25zdHJ1Y3RvcixcbiAgZW5jb2RlQXJndW1lbnRzLFxuICBlbmNvZGVJbnB1dERhdGEsXG4gIGdldEFiaUZ1bmN0aW9ucyxcbiAgZ2V0QXJnVHlwZXNcbn0gZnJvbSBcIi4vYWJpLXRvLWJ5dGVcIjtcblxuZXhwb3J0IHR5cGUgT3B0aW9ucyA9IHtcbiAgLy8gVGhlIGJ5dGUgY29kZSBvZiB0aGUgY29udHJhY3QuIFVzZWQgd2hlbiB0aGUgY29udHJhY3QgZ2V0cyBkZXBsb3llZFxuICBkYXRhPzogQnVmZmVyO1xuICBwcm92aWRlcj86IElScGNNZXRob2Q7XG4gIHNpZ25lcj86IFNpZ25lclBsdWdpbjtcbn07XG5cbmV4cG9ydCBjbGFzcyBDb250cmFjdCB7XG4gIC8vIFRoZSBqc29uIGludGVyZmFjZSBmb3IgdGhlIGNvbnRyYWN0IHRvIGluc3RhbnRpYXRlXG4gIHByaXZhdGUgcmVhZG9ubHkgYWJpPzogQWJpQnlGdW5jO1xuXG4gIC8vIFRoaXMgYWRkcmVzcyBpcyBuZWNlc3NhcnkgZm9yIGV4ZWN1dGlvbnMgYW5kIGNhbGwgcmVxdWVzdHNcbiAgcHJpdmF0ZSByZWFkb25seSBhZGRyZXNzPzogc3RyaW5nO1xuXG4gIC8vIFRoZSBvcHRpb25zIG9mIHRoZSBjb250cmFjdC5cbiAgcHJpdmF0ZSByZWFkb25seSBvcHRpb25zPzogT3B0aW9ucztcblxuICBwdWJsaWMgcHJvdmlkZXI/OiBJUnBjTWV0aG9kO1xuXG4gIHB1YmxpYyByZWFkb25seSBtZXRob2RzOiB7IFtmdW5jTmFtZTogc3RyaW5nXTogRnVuY3Rpb24gfTtcblxuICBwdWJsaWMgc2V0UHJvdmlkZXIocHJvdmlkZXI6IElScGNNZXRob2QpOiB2b2lkIHtcbiAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXI7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWFueVxuICAgIGpzb25JbnRlcmZhY2U/OiBBcnJheTxhbnk+LFxuICAgIGFkZHJlc3M/OiBzdHJpbmcsXG4gICAgb3B0aW9ucz86IE9wdGlvbnNcbiAgKSB7XG4gICAgdGhpcy5wcm92aWRlciA9IG9wdGlvbnMgJiYgb3B0aW9ucy5wcm92aWRlcjtcbiAgICBpZiAoanNvbkludGVyZmFjZSkge1xuICAgICAgdGhpcy5hYmkgPSBnZXRBYmlGdW5jdGlvbnMoanNvbkludGVyZmFjZSk7XG4gICAgfVxuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3M7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcblxuICAgIC8vIG1vdW50IG1ldGhvZHNcbiAgICB0aGlzLm1ldGhvZHMgPSB7fTtcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWZvci1pblxuICAgIGZvciAoY29uc3QgZnVuYyBpbiB0aGlzLmFiaSkge1xuICAgICAgaWYgKCF0aGlzLmFiaS5oYXNPd25Qcm9wZXJ0eShmdW5jKSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29udGludWVcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubWV0aG9kc1tmdW5jXSA9IGFzeW5jIChcbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAuLi5hcmdzXG4gICAgICApID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmFkZHJlc3MgfHwgIXRoaXMuYWJpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibXVzdCBzZXQgY29udHJhY3QgYWRkcmVzcyBhbmQgYWJpXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtdXN0IHNldCBtZXRob2QgZXhlY3V0ZSBwYXJhbWV0ZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnByb3ZpZGVyKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibm8gcnBjIG1ldGhvZCBwcm92aWRlciBzcGVjaWZpZWRcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXhlY3V0ZVBhcmFtZXRlciA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgY29uc3QgYWJpRnVuYyA9IHRoaXMuYWJpW2Z1bmNdO1xuICAgICAgICBjb25zdCB1c2VySW5wdXQgPSB7fTtcbiAgICAgICAgaWYgKCFhYmlGdW5jLmlucHV0cyB8fCAhQXJyYXkuaXNBcnJheShhYmlGdW5jLmlucHV0cykpIHtcbiAgICAgICAgICByZXR1cm4gdXNlcklucHV0O1xuICAgICAgICB9XG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55XG4gICAgICAgIGFiaUZ1bmMuaW5wdXRzLm1hcCgodmFsOiBhbnksIGk6IG51bWJlcikgPT4ge1xuICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICB1c2VySW5wdXRbdmFsLm5hbWVdID0gYXJnc1tpXTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGFiaUZ1bmMuc3RhdGVNdXRhYmlsaXR5ID09PSBcInZpZXdcIikge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucHJvdmlkZXIucmVhZENvbnRyYWN0KHtcbiAgICAgICAgICAgIGV4ZWN1dGlvbjogdGhpcy5wdXJlRW5jb2RlTWV0aG9kKFxuICAgICAgICAgICAgICBcIjBcIixcbiAgICAgICAgICAgICAgZnVuYyxcbiAgICAgICAgICAgICAgLi4uYXJncy5zbGljZSgxLCBhcmdzLmxlbmd0aClcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBjYWxsZXJBZGRyZXNzOiB0aGlzLmFkZHJlc3NcbiAgICAgICAgICB9KTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5kZWNvZGVNZXRob2RSZXN1bHQoZnVuYywgcmVzdWx0LmRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbWV0aG9kRW52ZWxvcCA9IHRoaXMuZW5jb2RlTWV0aG9kKFxuICAgICAgICAgIGV4ZWN1dGVQYXJhbWV0ZXIuYW1vdW50IHx8IFwiMFwiLFxuICAgICAgICAgIGZ1bmMsXG4gICAgICAgICAgdXNlcklucHV0LFxuICAgICAgICAgIGV4ZWN1dGVQYXJhbWV0ZXIuZ2FzTGltaXQsXG4gICAgICAgICAgZXhlY3V0ZVBhcmFtZXRlci5nYXNQcmljZVxuICAgICAgICApO1xuICAgICAgICBjb25zdCBtZXRob2QgPSBuZXcgRXhlY3V0aW9uTWV0aG9kKFxuICAgICAgICAgIHRoaXMucHJvdmlkZXIsXG4gICAgICAgICAgZXhlY3V0ZVBhcmFtZXRlci5hY2NvdW50LFxuICAgICAgICAgIG1ldGhvZEVudmVsb3AsXG4gICAgICAgICAgeyBzaWduZXI6IHRoaXMub3B0aW9ucyAmJiB0aGlzLm9wdGlvbnMuc2lnbmVyIH1cbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gbWV0aG9kLmV4ZWN1dGUoKTtcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1hbnlcbiAgcHVibGljIGdldEFCSSgpOiBBYmlCeUZ1bmMgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmFiaTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRBZGRyZXNzKCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgcmV0dXJuIHRoaXMuYWRkcmVzcztcbiAgfVxuXG4gIHB1YmxpYyBhc3luYyBkZXBsb3koXG4gICAgYWNjb3VudDogSUFjY291bnQsXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiBuby1hbnlcbiAgICBpbnB1dHM6IEFycmF5PGFueT4sXG4gICAgZ2FzTGltaXQ/OiBzdHJpbmcgfCB1bmRlZmluZWQsXG4gICAgZ2FzUHJpY2U/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAoIXRoaXMub3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwibXVzdCBzZXQgY29udHJhY3QgYnl0ZSBjb2RlXCIpO1xuICAgIH1cbiAgICBpZiAoIXRoaXMucHJvdmlkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIm5vIHJwYyBtZXRob2QgcHJvdmlkZXIgc3BlY2lmaWVkXCIpO1xuICAgIH1cblxuICAgIGxldCBkYXRhID0gdGhpcy5vcHRpb25zLmRhdGEgfHwgQnVmZmVyLmZyb20oW10pO1xuICAgIGlmICh0aGlzLmFiaSAmJiB0aGlzLmFiaS5oYXNPd25Qcm9wZXJ0eShDb25zdHJ1Y3RvcikpIHtcbiAgICAgIGNvbnN0IGFiaUZ1bmMgPSB0aGlzLmFiaVtDb25zdHJ1Y3Rvcl07XG4gICAgICBjb25zdCB1c2VySW5wdXQgPSB7fTtcbiAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgIGlmICghYWJpRnVuYy5pbnB1dHMgfHwgIUFycmF5LmlzQXJyYXkoYWJpRnVuYy5pbnB1dHMpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImNvbnN0cnV0b3IgaW5wdXQgZXJyb3JcIik7XG4gICAgICB9XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IG5vLWFueVxuICAgICAgYWJpRnVuYy5pbnB1dHMubWFwKCh2YWw6IGFueSwgaTogbnVtYmVyKSA9PiB7XG4gICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgdXNlcklucHV0W3ZhbC5uYW1lXSA9IGlucHV0c1tpXTtcbiAgICAgIH0pO1xuICAgICAgZGF0YSA9IEJ1ZmZlci5jb25jYXQoW1xuICAgICAgICBkYXRhLFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIEJ1ZmZlci5mcm9tKGVuY29kZUFyZ3VtZW50cyhnZXRBcmdUeXBlcyhhYmlGdW5jKSwgdXNlcklucHV0KSwgXCJoZXhcIilcbiAgICAgIF0pO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbnRyYWN0RW52ZWxvcCA9IHtcbiAgICAgIGdhc0xpbWl0OiBnYXNMaW1pdCxcbiAgICAgIGdhc1ByaWNlOiBnYXNQcmljZSxcbiAgICAgIGNvbnRyYWN0OiBcIlwiLFxuICAgICAgYW1vdW50OiBcIjBcIixcbiAgICAgIGRhdGE6IGRhdGFcbiAgICB9O1xuICAgIHJldHVybiBuZXcgRXhlY3V0aW9uTWV0aG9kKHRoaXMucHJvdmlkZXIsIGFjY291bnQsIGNvbnRyYWN0RW52ZWxvcCwge1xuICAgICAgc2lnbmVyOiB0aGlzLm9wdGlvbnMgJiYgdGhpcy5vcHRpb25zLnNpZ25lclxuICAgIH0pLmV4ZWN1dGUoKTtcbiAgfVxuXG4gIHB1YmxpYyBwdXJlRW5jb2RlTWV0aG9kKFxuICAgIGFtb3VudDogc3RyaW5nLFxuICAgIG1ldGhvZDogc3RyaW5nLFxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHR5cGVkZWZcbiAgICAuLi5hcmdzXG4gICk6IEV4ZWN1dGlvbiB7XG4gICAgaWYgKCF0aGlzLmFkZHJlc3MgfHwgIXRoaXMuYWJpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtdXN0IHNldCBjb250cmFjdCBhZGRyZXNzIGFuZCBhYmlcIik7XG4gICAgfVxuICAgIGlmICghdGhpcy5hYmlbbWV0aG9kXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBtZXRob2QgJHttZXRob2R9IGRvc2Ugbm90IGluIGFiaWApO1xuICAgIH1cbiAgICBjb25zdCBhYmlGdW5jID0gdGhpcy5hYmlbbWV0aG9kXTtcblxuICAgIGNvbnN0IHVzZXJJbnB1dCA9IHt9O1xuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbm8tYW55XG4gICAgYWJpRnVuYy5pbnB1dHMubWFwKCh2YWw6IGFueSwgaTogbnVtYmVyKSA9PiB7XG4gICAgICAvLyBAdHMtaWdub3JlXG4gICAgICB1c2VySW5wdXRbdmFsLm5hbWVdID0gYXJnc1tpXTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzLmVuY29kZU1ldGhvZChhbW91bnQsIG1ldGhvZCwgdXNlcklucHV0KTtcbiAgfVxuXG4gIHB1YmxpYyBlbmNvZGVNZXRob2QoXG4gICAgYW1vdW50OiBzdHJpbmcsXG4gICAgbWV0aG9kOiBzdHJpbmcsXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxuICAgIGlucHV0OiB7IFtrZXk6IHN0cmluZ106IGFueSB9LFxuICAgIGdhc0xpbWl0Pzogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgIGdhc1ByaWNlPzogc3RyaW5nXG4gICk6IEV4ZWN1dGlvbiB7XG4gICAgaWYgKCF0aGlzLmFkZHJlc3MgfHwgIXRoaXMuYWJpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJtdXN0IHNldCBjb250cmFjdCBhZGRyZXNzIGFuZCBhYmlcIik7XG4gICAgfVxuICAgIGlmICghdGhpcy5hYmlbbWV0aG9kXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBtZXRob2QgJHttZXRob2R9IGRvc2Ugbm90IGluIGFiaWApO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBnYXNMaW1pdDogZ2FzTGltaXQsXG4gICAgICBnYXNQcmljZTogZ2FzUHJpY2UsXG4gICAgICBjb250cmFjdDogdGhpcy5hZGRyZXNzLFxuICAgICAgYW1vdW50OiBhbW91bnQsXG4gICAgICBkYXRhOiBCdWZmZXIuZnJvbShlbmNvZGVJbnB1dERhdGEodGhpcy5hYmksIG1ldGhvZCwgaW5wdXQpLCBcImhleFwiKVxuICAgIH07XG4gIH1cblxuICBwdWJsaWMgZGVjb2RlTWV0aG9kUmVzdWx0KG1ldGhvZDogc3RyaW5nLCByZXN1bHQ6IHN0cmluZyk6IGFueSB8IEFycmF5PGFueT4ge1xuICAgIGNvbnN0IG91dFR5cGVzID0gW10gYXMgQXJyYXk8c3RyaW5nPjtcblxuICAgIC8vIEB0cy1pZ25vcmVcbiAgICB0aGlzLmdldEFCSSgpW21ldGhvZF0ub3V0cHV0cy5mb3JFYWNoKGZpZWxkID0+IHtcbiAgICAgIG91dFR5cGVzLnB1c2goZmllbGQudHlwZSk7XG4gICAgfSk7XG5cbiAgICBpZiAob3V0VHlwZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHRzID0gZXRoZXJldW1qcy5yYXdEZWNvZGUob3V0VHlwZXMsIEJ1ZmZlci5mcm9tKHJlc3VsdCwgXCJoZXhcIikpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvdXRUeXBlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKG91dFR5cGVzW2ldID09PSBcImFkZHJlc3NcIikge1xuICAgICAgICByZXN1bHRzW2ldID0gZnJvbUJ5dGVzKFxuICAgICAgICAgIEJ1ZmZlci5mcm9tKHJlc3VsdHNbaV0udG9TdHJpbmcoKSwgXCJoZXhcIilcbiAgICAgICAgKS5zdHJpbmcoKTtcbiAgICAgIH1cbiAgICAgIGlmIChvdXRUeXBlc1tpXSA9PT0gXCJhZGRyZXNzW11cIikge1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJlc3VsdHNbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICByZXN1bHRzW2ldW2pdID0gZnJvbUJ5dGVzKFxuICAgICAgICAgICAgQnVmZmVyLmZyb20ocmVzdWx0c1tpXVtqXS50b1N0cmluZygpLCBcImhleFwiKVxuICAgICAgICAgICkuc3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAob3V0VHlwZXMubGVuZ3RoID09PSAxKSB7XG4gICAgICByZXR1cm4gcmVzdWx0c1swXTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBNZXRob2RFeGVjdXRlUGFyYW1ldGVyIHtcbiAgYWNjb3VudDogSUFjY291bnQ7XG4gIGFtb3VudD86IHN0cmluZztcbiAgZ2FzTGltaXQ/OiBzdHJpbmc7XG4gIGdhc1ByaWNlPzogc3RyaW5nO1xufVxuIl19
